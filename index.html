<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>iPad Emulator</title>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: sans-serif; overflow: hidden; }
        canvas { width: 100vw; height: auto; image-rendering: pixelated; }
        #controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 20px; }
        button { padding: 15px; background: #333; color: white; border: none; border-radius: 10px; -webkit-user-select: none; }
    </style>
</head>
<body>
    <canvas id="screen"></canvas>
    <div id="controls">
        <button id="start">START / UNMUTE</button>
        <input type="file" id="upload" accept=".gba">
    </div>

    <script src="https://unpkg.com/@gbajs/gbajs@latest/dist/index.js"></script>
    <script>
        const gba = new GameBoyAdvance();
        gba.setCanvas(document.getElementById('screen'));

        // iPadの音声制限解除
        document.getElementById('start').addEventListener('click', () => {
            gba.audio.context.resume();
            alert("Ready!");
        });

        document.getElementById('upload').onchange = function() {
            const reader = new FileReader();
            reader.onload = function(e) {
                gba.loadRom(e.target.result, (err, result) => {
                    if (err) return alert(err);
                    gba.runAnimation();
                });
            };
            reader.readAsArrayBuffer(this.files[0]);
        };
    </script>
</body>
</html>
